---
title: "XR4ALL_Survey_1"
author: "Alexander Masurovsky"
date: "5/5/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(tidy = TRUE, message = FALSE, warning = FALSE, echo=FALSE)
```

```{r load_in, include = FALSE, echo=FALSE}
Packages = c("dplyr", "ggplot2","pastecs", "rcompanion", "reshape2", "Rmisc", "here", "tidyverse", "stringr", "readxl", "wesanderson") 
lapply(Packages, library, character.only = TRUE)

raw_responses <- read_excel("results-survey-2020_05_12.xlsx")

# dataset for all that completed the first page
completed_first_page <- raw_responses %>% filter(lastpage==1 | lastpage==2)

# dataset for only those that completed the whole survey
completed_full_survey <- raw_responses %>% filter(lastpage==2)

```

```{r overall}
n_first_page <- nrow(completed_first_page)
n_completed <- nrow(completed_full_survey)

```

`r n_first_page` people completed the first page.

`r n_completed` people completed the whole survey.

```{r completed_first_page}

# Q1 I am a...
# * Q01UserType[SQ001] - Unity developer (any level)
# * Q01UserType[SQ002] - Therapist or clinician
# * Q01UserType[SQ003] - Researcher
# * Q01UserType[SQ004] - Involved with marketing or product testing
# * Q01UserType[other] - Other: _____________

# subset question 1 responses
Q1 <- completed_first_page %>% select(id, contains("Q01UserType"))

# count responses per person
Q1_counts <- Q1
Q1_counts[which(is.na(Q1$`Q01UserType[other]`)),"Q01UserType[other]"] <- "No"
Q1_counts[which(Q1$`Q01UserType[other]`!="No"),"Q01UserType[other]"] <- "Yes"
for (i in 1:length(Q1_counts[[1]])){
  this_row <- t(Q1_counts[i,c(2:6)])
  row.names(this_row) <- NULL
  Q1_counts[i,"yes_count"] <- sum(as.vector(this_row)=="Yes")
}

# add column "yes_count" to identify which people put more than one response
Q1 <- left_join(Q1, select(Q1_counts, id, yes_count))

# relevant counts
relevant_counts <-
    data.frame(categories=c("Unity dev (only)",
                            "Both researcher & Unity dev",
                            "Researcher (only)",
                            "Also therapist/clinician",
                            "Also marketing/product testing",
                            "Also other",
                            "Only other"),
               counts=c(nrow(Q1 %>% filter(`Q01UserType[SQ001]`=="Yes" & yes_count==1)),
                        nrow(Q1 %>% filter(`Q01UserType[SQ001]`=="Yes" &`Q01UserType[SQ003]`=="Yes")),
                        nrow(Q1 %>% filter(`Q01UserType[SQ003]`=="Yes" & yes_count==1)),
                        nrow(Q1 %>% filter(`Q01UserType[SQ002]`=="Yes")),
                        nrow(Q1 %>% filter(`Q01UserType[SQ004]`=="Yes")),
                        nrow(Q1 %>% filter(is.na(`Q01UserType[other]`)==FALSE & yes_count > 1)),
                        nrow(Q1 %>% filter(is.na(`Q01UserType[other]`)==FALSE & yes_count == 1))))
relevant_counts$categories <- factor(relevant_counts$categories, levels=relevant_counts$categories)


ggplot(relevant_counts, aes(categories, counts, fill=categories))+
  geom_bar(aes(fill=categories), stat="identity", position="dodge")+
  scale_x_discrete(labels=NULL)+
  labs(title="User Types", x=NULL, y=NULL,
       caption=paste0("(completed first 3 questions, n = ", n_first_page, ")"))+
  #coord_flip()+labs()+
  theme_minimal()+
  geom_text(aes(label=counts, y=counts-.6), color="white", size=3.5)

Q1_other <- completed_first_page %>% filter(is.na(`Q01UserType[other]`) == FALSE) %>%
  select(id, `Q01UserType[other]`)
cat("\nQ1 - Other responses:")
Q1_other

# Q2 Interested? Yes/No
Q2_yes <- completed_first_page %>% filter(Q02Interest=="Yes")
Q2_yes <- Q2_yes %>% left_join(Q1_counts %>% select(id, yes_count))
Q2_yes_breakdown <-
    data.frame(categories=c("Unity dev (only)",
                            "Both researcher & Unity dev",
                            "Researcher (only)",
                            "Also therapist/clinician",
                            "Also marketing/product testing",
                            "Other"),
               counts=c(nrow(Q2_yes %>% filter(`Q01UserType[SQ001]`=="Yes" & yes_count==1)),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ001]`=="Yes" &`Q01UserType[SQ003]`=="Yes")),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ003]`=="Yes" & yes_count==1)),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ002]`=="Yes")),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ004]`=="Yes")),
                        nrow(Q2_yes %>% filter(is.na(`Q01UserType[other]`)==FALSE))))
Q2_yes_breakdown$categories <- factor(Q2_yes_breakdown$categories, levels=Q2_yes_breakdown$categories)

Q2_no <- completed_first_page %>% filter(Q02Interest=="No") %>%
  left_join(Q1_counts %>% select(id, yes_count))
Q2_no_breakdown <- data.frame(categories=c("Unity dev (only)",
                            "Both researcher & Unity dev",
                            "Researcher (only)",
                            "Also therapist/clinician",
                            "Also marketing/product testing",
                            "Other"),
               counts=c(nrow(Q2_no %>% filter(`Q01UserType[SQ001]`=="Yes" & yes_count==1)),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ001]`=="Yes" &`Q01UserType[SQ003]`=="Yes")),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ003]`=="Yes" & yes_count==1)),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ002]`=="Yes")),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ004]`=="Yes")),
                        nrow(Q2_no %>% filter(is.na(`Q01UserType[other]`)==FALSE))))
Q2_no_breakdown$categories <- factor(Q2_no_breakdown$categories, levels=Q2_no_breakdown$categories)
  

ggplot(Q2_yes_breakdown, aes(x="Yes", y=counts, fill=categories))+
  geom_bar(stat="identity", position="stack")+
  geom_bar(data=Q2_no_breakdown, aes(x="No", y=counts, fill=categories), stat="identity")+
  labs(title = "Are you interested in this plugin?", fill="User type", y=NULL, x=NULL)+
  theme_minimal()+
  scale_x_discrete(labels = (c(paste0("No (", sum(Q2_no_breakdown$counts),")"),
                            paste0("Yes (", sum(Q2_yes_breakdown$counts), ")"))))
ggsave("interest.jpg")

# Q3 What feature are you most interested in?
Q3_counts <- data.frame(categories = c("Make reactive Unity software", "Observe user reactions while using", "Analyze user reactions after use", "Improve measurement tools","Other"),
           counts = c(nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ001]`=="Yes")),
                      nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ002]`=="Yes")),
                      nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ003]`=="Yes")),
                      nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ004]`=="Yes")),
                      nrow(completed_first_page %>% filter(is.na(`Q03WhyInterested[other]`)==FALSE))))
Q3_counts$categories <- factor(Q3_counts$categories, levels=Q3_counts$categories)
ggplot(Q3_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+theme_minimal()+
  labs(title="Q3 What feature are you most interested in?", x=NULL, fill=NULL)+
  scale_x_discrete(labels=NULL)+
geom_text(aes(label=counts), vjust=1.2, color="white", size=3.5)
ggsave("why_interested.jpg")

# Q3 - amongst Devs
Q3_counts <- data.frame(categories = c("Make reactive Unity software", "Observe user reactions while using", "Analyze user reactions after use", "Improve measurement tools","Other"),
   counts = c(nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ001]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ002]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ003]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ004]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(is.na(`Q03WhyInterested[other]`)==FALSE, `Q01UserType[SQ001]`=="Yes"))))
Q3_counts$categories <- factor(Q3_counts$categories, levels=Q3_counts$categories)

ggplot(Q3_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+theme_minimal()+
  labs(title="Q3 What feature are you most interested in?", subtitle="(Unity devs)",
  x=NULL, fill=NULL,
  caption=paste0("n = ", nrow(completed_first_page %>% filter(`Q01UserType[SQ001]`=="Yes"))))+
  scale_x_discrete(labels=NULL)+
geom_text(aes(label=counts), vjust=1.2, color="white", size=3.5)
ggsave("what_feature_developers.jpg")

# Q3 - amongst researchers
Q3_counts <- data.frame(categories = c("Make reactive Unity software", "Observe user reactions while using", "Analyze user reactions after use", "Improve measurement tools","Other"),
   counts = c(nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ001]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ002]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ003]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ004]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(is.na(`Q03WhyInterested[other]`)==FALSE, `Q01UserType[SQ003]`=="Yes"))))
Q3_counts$categories <- factor(Q3_counts$categories, levels=Q3_counts$categories)

ggplot(Q3_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+theme_minimal()+
  labs(title="Q3 What feature are you most interested in?", subtitle="(Researchers)",
  x=NULL, fill=NULL,
  caption=paste0("n = ", nrow(completed_first_page %>% filter(`Q01UserType[SQ003]`=="Yes"))))+
  scale_x_discrete(labels=NULL)+
  geom_text(aes(label=counts), vjust=1.2, color="white", size=3.5)
ggsave("what_feature_researchers.jpg")

```

```{r completed_survey}
Q1 <- completed_full_survey %>% select(id, contains("Q01UserType"))

# count responses per person
Q1_counts <- Q1
Q1_counts[which(is.na(Q1$`Q01UserType[other]`)),"Q01UserType[other]"] <- "No"
Q1_counts[which(Q1$`Q01UserType[other]`!="No"),"Q01UserType[other]"] <- "Yes"
for (i in 1:length(Q1_counts[[1]])){
  this_row <- t(Q1_counts[i,c(2:6)])
  row.names(this_row) <- NULL
  Q1_counts[i,"yes_count"] <- sum(as.vector(this_row)=="Yes")
}

# add column "yes_count" to identify which people put more than one response
Q1 <- left_join(Q1, select(Q1_counts, id, yes_count))

plot_x_lims = c(-2,8)
xmin_l = 6
xmax_l = 7
xmin_s = 0
xmax_s = 1

# relevant counts
relevant_counts <-
    data.frame(categories=c("Unity dev (only)",
                            "Both researcher \n& Unity dev",
                            "Researcher (only)"),
                           # "Also therapist/clinician",
                            #"Also marketing/product testing",
                            #"Also other"),
               counts=c(nrow(Q1 %>% filter(`Q01UserType[SQ001]`=="Yes" & `Q01UserType[SQ003]`=="No")),
                        nrow(Q1 %>% filter(`Q01UserType[SQ001]`=="Yes" &`Q01UserType[SQ003]`=="Yes")),
                        nrow(Q1 %>% filter(`Q01UserType[SQ001]`=="No" & `Q01UserType[SQ003]`=="Yes"))))#,
                       # nrow(Q1 %>% filter(`Q01UserType[SQ002]`=="Yes")),
                      #  nrow(Q1 %>% filter(`Q01UserType[SQ004]`=="Yes")),
                      #  nrow(Q1 %>% filter(is.na(`Q01UserType[other]`)==FALSE & yes_count > 1))))
relevant_counts$categories <- factor(relevant_counts$categories, levels=relevant_counts$categories)

#  set up donut plot
relevant_counts$fraction = relevant_counts$count / sum(relevant_counts$count) # maybe make n instead
relevant_counts$xpos <- c(4.8, 4.0, 3.9) # position of outer circle labels
relevant_counts$ymax = cumsum(relevant_counts$fraction)
relevant_counts$ymin = c(0, head(relevant_counts$ymax, n=-1))
#relevant_counts$categories <- str_c(relevant_counts$categories, ' (', relevant_counts$count, ')')

counts2 <-
  data.frame(categories=c("Also therapist/\nclinician",
                            "Also marketing/\nproduct testing",
                            "Also other"),
               counts=c(nrow(Q1 %>% filter(`Q01UserType[SQ002]`=="Yes")),
                        nrow(Q1 %>% filter(`Q01UserType[SQ004]`=="Yes")),
                        nrow(Q1 %>% filter(is.na(`Q01UserType[other]`)==FALSE & yes_count > 1))))
counts2$fraction = counts2$count / sum(counts2$count) # maybe make n instead
counts2$ymax = cumsum(counts2$fraction)
counts2$ymin = c(0, head(counts2$ymax, n=-1))


# plot
ggplot(relevant_counts, aes(fill=categories, ymax=ymax, ymin=ymin, xmin=xmin_l, xmax=xmax_l))+
  geom_rect()+
  xlim(plot_x_lims)+ # modify thickness; larger range = smaller, thinner plot
  coord_polar(theta="y", start=0)+ # comment this out to better visualize x-y plane
  geom_rect(data=counts2, aes(xmin=xmin_s, xmax=xmax_s))+
  scale_fill_brewer(palette = "Blues")+ #"Dark2")+
  scale_color_brewer(palette = "Blues")+ #copy above
  labs(title="User Types", x=NULL, y=NULL, fill="User type",
       caption=paste0("n = ", n_completed))+
  theme_void()+
  theme(legend.position='none', plot.title = element_text(hjust=.5, vjust = -7, size=18),
        plot.caption=element_text(vjust=20, hjust = .8, face="italic"))+
  #guides(fill = guide_legend(reverse = TRUE))+
  # fiddle with the x position here to move labels in/out:
  geom_text(aes(label=categories, x=xpos, y=(ymax+ymin)/2), size=3.5)+
  geom_text(aes(label=counts, x=(xmin_l+xmax_l)/2, y=(ymax+ymin)/2), size=3.5, color="white")+
  geom_text(data=counts2, aes(label=categories, x=xmax_s+1, y=(ymax+ymin)/2), size=2.5, color="Grey2")+
  geom_text(data=counts2, aes(label=counts, x=(xmin_s+xmamx_s)/2, y=(ymax+ymin)/2), size=3.5, color="Grey2")
ggsave("Q1_user_types_completed_survey_donut.jpg")


Q1_other <- completed_full_survey %>% filter(is.na(`Q01UserType[other]`) == FALSE) %>%
  select(id, `Q01UserType[other]`)
cat("\nQ1 - Other responses:")
Q1_other

# Q2 Interested? Yes/No
Q2_yes <- completed_first_page %>% filter(Q02Interest=="Yes")
Q2_yes <- Q2_yes %>% left_join(Q1_counts %>% select(id, yes_count))
Q2_yes_breakdown <-
    data.frame(categories=c("Unity dev (only)",
                            "Both researcher & Unity dev",
                            "Researcher (only)",
                            "Also therapist/clinician",
                            "Also marketing/product testing",
                            "Other"),
               counts=c(nrow(Q2_yes %>% filter(`Q01UserType[SQ001]`=="Yes" & yes_count==1)),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ001]`=="Yes" &`Q01UserType[SQ003]`=="Yes")),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ003]`=="Yes" & yes_count==1)),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ002]`=="Yes")),
                        nrow(Q2_yes %>% filter(`Q01UserType[SQ004]`=="Yes")),
                        nrow(Q2_yes %>% filter(is.na(`Q01UserType[other]`)==FALSE))))
Q2_yes_breakdown$categories <- factor(Q2_yes_breakdown$categories, levels=Q2_yes_breakdown$categories)

Q2_no <- completed_first_page %>% filter(Q02Interest=="No") %>%
  left_join(Q1_counts %>% select(id, yes_count))
Q2_no_breakdown <- data.frame(categories=c("Unity dev (only)",
                            "Both researcher & Unity dev",
                            "Researcher (only)",
                            "Also therapist/clinician",
                            "Also marketing/product testing",
                            "Other"),
               counts=c(nrow(Q2_no %>% filter(`Q01UserType[SQ001]`=="Yes" & yes_count==1)),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ001]`=="Yes" &`Q01UserType[SQ003]`=="Yes")),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ003]`=="Yes" & yes_count==1)),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ002]`=="Yes")),
                        nrow(Q2_no %>% filter(`Q01UserType[SQ004]`=="Yes")),
                        nrow(Q2_no %>% filter(is.na(`Q01UserType[other]`)==FALSE))))
Q2_no_breakdown$categories <- factor(Q2_no_breakdown$categories, levels=Q2_no_breakdown$categories)
  

ggplot(Q2_yes_breakdown, aes(x="Yes", y=counts, fill=categories))+
  geom_bar(stat="identity", position="stack")+
  geom_bar(data=Q2_no_breakdown, aes(x="No", y=counts, fill=categories), stat="identity")+
  labs(title = "Are you interested in this plugin?", fill="User type", y=NULL, x=NULL)+
  theme_minimal()+
  scale_x_discrete(labels = (c(paste0("No (", sum(Q2_no_breakdown$counts),")"),
                            paste0("Yes (", sum(Q2_yes_breakdown$counts), ")"))))
ggsave("interest.jpg")

# Q3 What feature are you most interested in?
Q3_counts <- data.frame(categories = c("Make reactive Unity software", "Observe user reactions while using", "Analyze user reactions after use", "Improve measurement tools","Other"),
           counts = c(nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ001]`=="Yes")),
                      nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ002]`=="Yes")),
                      nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ003]`=="Yes")),
                      nrow(completed_first_page %>% filter(`Q03WhyInterested[SQ004]`=="Yes")),
                      nrow(completed_first_page %>% filter(is.na(`Q03WhyInterested[other]`)==FALSE)))) %>%
  arrange(desc(counts))
Q3_counts$categories <- factor(Q3_counts$categories, levels=Q3_counts$categories)

# plot option 1 (bar)
ggplot(Q3_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+theme_minimal()+
  labs(title="Which features of the Excite-O-Meter are you most interested in using?", x=NULL, fill=NULL,
       caption=paste0("n = ",n_completed))+
  scale_fill_brewer(palette="Blues", direction=-1)+
  theme(plot.title = element_text(face = "bold"), plot.caption = element_text(face = "italic"))+
  scale_x_discrete(labels=NULL)+
  #guides(fill= guide_legend(reverse = TRUE))+
  geom_text(aes(label=counts, y=counts-1), color="white", size=3.5)
ggsave("Q3_why_interested_bar.jpg")

# plot option 2 (round)
Q3_counts <- Q3_counts %>% arrange(counts)
Q3_counts$categories <- factor(Q3_counts$categories, levels=Q3_counts$categories)
ggplot(Q3_counts, aes(categories, counts, fill=categories))+
  ylim(c(0,n_completed))+
  geom_bar(stat="identity")+
  theme_void()+
  coord_polar(theta="y")+
  scale_fill_brewer(palette="Blues", direction=1)+
  scale_color_brewer(palette="Blues", direction=1)+
  labs(title="Which features of the Excite-O-Meter are you most interested in using?", x=NULL, color=NULL, fill=NULL,
       caption=paste0("n = ",n_completed))+
  #scale_x_discrete(labels=NULL)+
  geom_label(aes(label=counts, y=.25*n_completed,), fill="white", color="black", show.legend = FALSE)+
  guides(fill= guide_legend(reverse = TRUE))
ggsave("Q3_why_interested_round.jpg")

# # donut plot
# ggplot(relevant_counts, aes(fill=categories, ymax=ymax, ymin=ymin, xmin=xmin_l, xmax=xmax_l))+
#   geom_rect()+
#   xlim(plot_x_lims)+ # modify thickness; larger range = smaller, thinner plot
#   coord_polar(theta="y", start=0)+ # comment this out to better visualize x-y plane
#   geom_rect(data=counts2, aes(xmin=xmin_s, xmax=xmax_s))+
#   scale_fill_brewer(palette = "Blues")+ #"Dark2")+
#   scale_color_brewer(palette = "Blues")+ #copy above
#   labs(title="User Types", x=NULL, y=NULL, fill="User type",
#        caption=paste0("n = ", n_completed))+
#   theme_void()+
#   theme(legend.position='none', plot.title = element_text(hjust=.5, vjust = -7, size=18),
#         plot.caption=element_text(vjust=20, hjust = .8, face="italic"))+
#   #guides(fill = guide_legend(reverse = TRUE))+
#   # fiddle with the x position here to move labels in/out:
#   geom_text(aes(label=categories, x=xpos, y=(ymax+ymin)/2), size=3.5)+
#   geom_text(aes(label=counts, x=(xmin_l+xmax_l)/2, y=(ymax+ymin)/2), size=3.5, color="white")+
#   geom_text(data=counts2, aes(label=categories, x=xmax_s+1, y=(ymax+ymin)/2), size=2.5, color="Grey2")+
#   geom_text(data=counts2, aes(label=counts, x=(xmin_s+xmamx_s)/2, y=(ymax+ymin)/2), size=3.5, color="Grey2")
# ggsave("Q1_user_types_completed_survey_donut.jpg")

# Q3 - amongst Devs
Q3_counts <- data.frame(categories = c("Make reactive Unity software", "Observe user reactions while using", "Analyze user reactions after use", "Improve measurement tools","Other"),
   counts = c(nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ001]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ002]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ003]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ004]`=="Yes", `Q01UserType[SQ001]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(is.na(`Q03WhyInterested[other]`)==FALSE, `Q01UserType[SQ001]`=="Yes"))))
Q3_counts$categories <- factor(Q3_counts$categories, levels=Q3_counts$categories)

ggplot(Q3_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+theme_minimal()+
  labs(title="Q3 What feature are you most interested in?", subtitle="(Unity devs)",
  x=NULL, fill=NULL,
  caption=paste0("n = ", nrow(completed_first_page %>% filter(`Q01UserType[SQ001]`=="Yes"))))+
  scale_x_discrete(labels=NULL)+
geom_text(aes(label=counts), vjust=1.2, color="white", size=3.5)
ggsave("what_feature_developers.jpg")

# Q3 - amongst researchers
Q3_counts <- data.frame(categories = c("Make reactive Unity software", "Observe user reactions while using", "Analyze user reactions after use", "Improve measurement tools","Other"),
   counts = c(nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ001]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ002]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ003]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(`Q03WhyInterested[SQ004]`=="Yes", `Q01UserType[SQ003]`=="Yes")),
              nrow(completed_first_page %>%
                     filter(is.na(`Q03WhyInterested[other]`)==FALSE, `Q01UserType[SQ003]`=="Yes"))))
Q3_counts$categories <- factor(Q3_counts$categories, levels=Q3_counts$categories)

ggplot(Q3_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+theme_minimal()+
  labs(title="Q3 What feature are you most interested in?", subtitle="(Researchers)",
  x=NULL, fill=NULL,
  caption=paste0("n = ", nrow(completed_first_page %>% filter(`Q01UserType[SQ003]`=="Yes"))))+
  scale_x_discrete(labels=NULL)+
  geom_text(aes(label=counts), vjust=1.2, color="white", size=3.5)
ggsave("what_feature_researchers.jpg")

# Q4 - How do you currently measure your users' experience?

  # Q04HowMeasure[SQ001] - record video of user or user's screen
  # Q04HowMeasure[SQ002] - analyze user behavior (controller responses; head, hand or eye movements)
  # Q04HowMeasure[SQ003] - asking the user (questionnaires or letting the user "think out loud")
  # Q04HowMeasure[SQ004] - physiological responses (heart rate, electrodermal activity, etc.)
  # Q04HowMeasure[SQ005] - brain measurements (e.g., EEG, MEG, fNIRS)
  # Q04HowMeasure[SQ006] - I do not measure user experience
  # Q04HowMeasure[other] - Other _________

Q4_total_counts <-
    data.frame(categories=c("Record video",
                            "Analyze behavior",
                            "Ask the user",
                            "Physiological (incl. HR)",
                            "Brain measurements",
                            "None",
                            "Other"),
               counts=c(nrow(completed_full_survey %>% filter(`Q04HowMeasure[SQ001]`=="Yes")),
                        nrow(completed_full_survey %>% filter(`Q04HowMeasure[SQ002]`=="Yes")),
                        nrow(completed_full_survey %>% filter(`Q04HowMeasure[SQ003]`=="Yes")),
                        nrow(completed_full_survey %>% filter(`Q04HowMeasure[SQ004]`=="Yes")),
                        nrow(completed_full_survey %>% filter(`Q04HowMeasure[SQ005]`=="Yes")),
                        nrow(completed_full_survey %>% filter(`Q04HowMeasure[SQ006]`=="Yes")),
                        nrow(completed_full_survey %>% filter(is.na(`Q04HowMeasure[other]`)==FALSE))))
Q4_total_counts$categories <- factor(Q4_total_counts$categories, levels=Q4_total_counts$categories)

# in case curious how many people chose multiple responses for Q4
Q4_num_selected <- completed_full_survey %>% select(id, contains("Q04"), -contains("Q045"))
Q4_num_selected[which(is.na(Q4_num_selected$`Q04HowMeasure[other]`)),"Q04HowMeasure[other]"] <- "No"
Q4_num_selected[which(Q4_num_selected$`Q04HowMeasure[other]`!="No"),"Q04HowMeasure[other]"] <- "Yes"
for (i in 1:nrow(Q4_num_selected)){
  this_row <- t(Q4_num_selected[i,c(2:7)])
  row.names(this_row) <- NULL
  Q4_num_selected[i,"yes_count"] <- sum(as.vector(this_row)=="Yes")
}

ggplot(Q4_total_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+
  theme_minimal()+
  theme(legend.position = "none", axis.text.x = element_text(angle=15, hjust=.7))+
  labs(title="Q4 How do you currently measure your users' experience?", x=NULL, y=NULL, fill=NULL)+
  #scale_x_discrete(labels=NULL)+
  #coord_flip()
  geom_text(aes(label=counts, y=counts-1), color="white") #,vjust=1.2)
ggsave("Q4_how_measure.jpg")

cat("\nPhysio")
Q4_other <- completed_full_survey %>% filter(is.na(`Q04HowMeasure[other]`)==FALSE) %>%
  select(id, contains("Q04"), -contains("Q045"))
names(Q4_other) <- as.vector(c("id",as.character(Q4_total_counts$categories)))

# Q4 ext - If you measure physiology, how so?
# Q045CurrentTools[SQ001] - which hardware? (free response)
# Q045CurrentTools[SQ002] - which software? (free response)
Q4_ext_responses <- completed_full_survey %>% filter(is.na(`Q045CurrentTools[SQ001]`) == FALSE) %>%
  select(id, hardware=`Q045CurrentTools[SQ001]`, software=`Q045CurrentTools[SQ002]`)
cat("If you measure physiology or brain, what hardware and software do you use?")
Q4_ext_responses

# Q5 - Unity proficiency (demographic)
Q05_proficiency_counts <- count(completed_full_survey$Q05ProficiencyUnity)
Q05_proficiency_counts$x <- 
  factor(Q05_proficiency_counts$x, levels=
           c("None","Beginner or hobbyist", "Intermediate professional",
             "Expert professional (e.g., Lead Developer)"))

ggplot(Q05_proficiency_counts, aes(x, freq, fill=x))+
  geom_bar(stat="identity")+theme_minimal()+theme(axis.text.x = element_blank())+
  labs(title="Q5 - Unity proficiency",x=NULL,y=NULL,fill="Proficiency",
       caption=paste0("n = ",sum(Q05_proficiency_counts$freq)))+
  geom_text(aes(label=freq), vjust=1.2, color="white", size=3.5)
  #coord_polar(theta="y")+
  #theme(panel.grid=element_blank())
  #theme(axis.text=element_blank())
  #theme(axis.ticks=element_blank()) +
  #labs(fill ="Level") +
  #theme(legend.position='left')

ggsave("Q05_proficiency.jpg")

# Q6 Industry (what kinds of apps do you make?)

  # Q06ApplicationTypes[SQ001] - Action/adventure games
  # Q06ApplicationTypes[SQ002] - Puzzle games
  # Q06ApplicationTypes[SQ003] - Cognitive enhancement
  # Q06ApplicationTypes[SQ004] - Exergames (fitness, dance or other movement)
  # Q06ApplicationTypes[SQ005] - Training
  # Q06ApplicationTypes[SQ006] - Virtual tourism
  # Q06ApplicationTypes[SQ007] - Clinical applications (physical, psychological, neurological)
  # Q06ApplicationTypes[SQ008] - Experimental design (e.g., neuroscience research)
  # Q06ApplicationTypes[SQ009] - 360 video/cinematography
  # Q06ApplicationTypes[SQ010] - Architecture/interior design
  # Q06ApplicationTypes[SQ011] - Adult entertainment
  # Q06ApplicationTypes[SQ012] - None/only do hardware
  # Q06ApplicationTypes[other] - Other _______

Q6_total_counts <-
    data.frame(
      categories=c("Action/adventure games",
                    "Puzzle games",
                    "Cognitive enhancement",
                    "Exergames",
                    "Training",
                    "Virtual tourism",
                    "Clinical applications",
                    "Experimental design",
                    "360 video/cinematography",
                    "Architecture/interior design",
                    "Adult entertainment",
                    "None/only hardware",
                    "Other"),
     counts=c(nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ001]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ002]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ003]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ004]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ005]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ006]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ007]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ008]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ009]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ010]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ011]`=="Yes")),
              nrow(completed_full_survey %>% filter(`Q06ApplicationTypes[SQ012]`=="Yes")),
              nrow(completed_full_survey %>% filter(is.na(`Q06ApplicationTypes[other]`)==FALSE))))

Q6_total_counts$categories <- factor(Q6_total_counts$categories, levels=Q6_total_counts$categories)

ggplot(Q6_total_counts, aes(categories, counts, fill=categories))+
  geom_bar(stat="identity", position="dodge")+
  theme_minimal()+
  theme(legend.position = "none")+ #, axis.text.x = element_text(angle=15, hjust=.7))+
  labs(title="Q6 - What kinds of applications are you involved with creating or testing", x=NULL, y=NULL, fill=NULL)+
  #scale_x_discrete(labels=NULL)+
  coord_flip()+
  scale_x_discrete(limits = rev(levels(Q6_total_counts$categories)))+
  geom_text(aes(label=counts, y=counts-1), color="white") #,vjust=1.2)
ggsave("Q6_how_measure.jpg")

# Q6 ext - Training for what industry?
Q6_ext_responses <- completed_full_survey %>%
  filter(`Q06ApplicationTypes[SQ005]` == "Yes", is.na(`Q065WhatIndustry`)==FALSE) %>%
  select(id, contains("Q065"))
Q6_ext_responses

# Q7 How often do you (or your company) pay for tools/plugins for Unity?
# Three or more times per year
# One or two times per yaer
# Less than once per year
# Never

Q7_counts <- count(completed_full_survey$Q07HowOftenPay)
Q7_counts$x <- 
  factor(Q7_counts$x, levels=
           c("Three or more times per year",
             "One or two times per year",
             "Less than once per year",
             "Never"))
ggplot(Q7_counts, aes(x, freq, fill=x))+
  geom_bar(stat="identity")+
  theme_minimal()+
  theme(legend.position="none", axis.text.x = element_text(angle=15, hjust=.7))+
  #theme(axis.text.x = element_blank())+
  labs(title="Q7 How often do you (or your company) pay for tools/plugins for Unity?",
       x=NULL,y=NULL, fill=NULL,
       caption=paste0("n = ",sum(Q7_counts$freq)))+
  geom_text(aes(label=freq), vjust=1.2, color="white", size=3.5)

ggsave("Q7_HowOftenPayForTools.jpg")

#Q8 How much would you be willing to pay for one Excite-O-Meter license?
  # € 100 - 300
  # € 51 - 100
  # € 31 - 50
  # € 26 - 30
  # € 11 - 25
  # € 1 - 10
Q8_counts <- count(completed_full_survey$Q08HowMuchWouldPay)
Q8_counts$x <- 
  factor(Q8_counts$x, levels=
           c("€ 100 - 300",
             "€ 51 - 100",
             "€ 31 - 50",
             "€ 26 - 30",
             "€ 11 - 25",
             "€ 1 - 10"))
ggplot(Q8_counts, aes(x, freq, fill=x))+
  geom_bar(stat="identity")+
  theme_minimal()+
  #theme(legend.position="none", axis.text.x = element_text(angle=15, hjust=.7))+
  theme(axis.text.x = element_blank())+
  labs(title="Q8 How much would you be willing to pay for one Excite-O-Meter license?",
       x=NULL,y=NULL, fill=NULL,
       caption=paste0("n = ",sum(Q8_counts$freq)))+
  geom_text(aes(label=freq), vjust=1.2, color="white", size=3.5)

ggsave("Q8_HowMuchWouldYouPay.jpg")

# how much would unity devs pay?
plotdata <- completed_full_survey %>% filter(`Q01UserType[SQ001]` == "Yes")
Q8_counts <- count(plotdata$Q08HowMuchWouldPay)
Q8_counts$x <- 
  factor(Q8_counts$x, levels=
           c("€ 100 - 300",
             "€ 51 - 100",
             "€ 31 - 50",
             "€ 26 - 30",
             "€ 11 - 25",
             "€ 1 - 10"))
ggplot(Q8_counts, aes(x, freq, fill=x))+
  geom_bar(stat="identity")+
  theme_minimal()+
  #theme(legend.position="none", axis.text.x = element_text(angle=15, hjust=.7))+
  theme(axis.text.x = element_blank())+
  labs(title="Q8 How much would you be willing to pay for one Excite-O-Meter license?",
       subtitle = "(Unity devs)",
       x=NULL,y=NULL, fill=NULL,
       caption=paste0("n = ",sum(Q8_counts$freq)))+
  geom_text(aes(label=freq), vjust=1.2, color="white", size=3.5)

# how much would researchers pay?
plotdata <- completed_full_survey %>% filter(`Q01UserType[SQ003]` == "Yes")
Q8_counts <- count(plotdata$Q08HowMuchWouldPay)
Q8_counts$x <- 
  factor(Q8_counts$x, levels=
           c("€ 100 - 300",
             "€ 51 - 100",
             "€ 31 - 50",
             "€ 26 - 30",
             "€ 11 - 25",
             "€ 1 - 10"))
ggplot(Q8_counts, aes(x, freq, fill=x))+
  geom_bar(stat="identity")+
  theme_minimal()+
  #theme(legend.position="none", axis.text.x = element_text(angle=15, hjust=.7))+
  theme(axis.text.x = element_blank())+
  labs(title="Q8 How much would you be willing to pay for one Excite-O-Meter license?",
       subtitle = "(Researchers)",
       x=NULL,y=NULL, fill=NULL,
       caption=paste0("n = ",sum(Q8_counts$freq)))+
  geom_text(aes(label=freq), vjust=1.2, color="white", size=3.5)

#Q9 What is the number one thing you want us to consider while developing this plugin?
Q9 <- completed_full_survey %>% filter(is.na(Q08WhatElse)==FALSE)
cat("Q9 What is the number one thing you want us to consider while developing this plugin?")
Q9 %>% select(id, `Q08WhatElse`)
cat(nrow(Q9)," respondents answered this question.")

```
